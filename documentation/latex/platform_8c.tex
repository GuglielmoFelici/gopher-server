\hypertarget{platform_8c}{}\section{src/platform.c File Reference}
\label{platform_8c}\index{src/platform.\+c@{src/platform.\+c}}
{\ttfamily \#include \char`\"{}../headers/platform.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../headers/protocol.\+h\char`\"{}}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$fcntl.\+h$>$}\newline
{\ttfamily \#include $<$pthread.\+h$>$}\newline
{\ttfamily \#include $<$signal.\+h$>$}\newline
{\ttfamily \#include $<$sys/file.\+h$>$}\newline
{\ttfamily \#include $<$sys/mman.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
{\ttfamily \#include $<$sys/types.\+h$>$}\newline
{\ttfamily \#include $<$syslog.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
Include dependency graph for platform.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{platform_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{platform_8c_a2b652b5d50088ca766e09ba7115e9a9e}{ends\+With} (cstring\+\_\+t str1, cstring\+\_\+t str2)
\item 
int \hyperlink{platform_8c_adb504f94873e3ed50a9fbc948b3f6244}{send\+All} (socket\+\_\+t s, cstring\+\_\+t data, int length)
\item 
int \hyperlink{platform_8c_aed6aaedf110cf3f079f707ca8c8a58a7}{get\+Cwd} (char $\ast$dst, size\+\_\+t size)
\item 
int \hyperlink{platform_8c_af8377fbc4061f7e7773e0ef33ac8a73f}{change\+Cwd} (const char $\ast$path)
\item 
void \hyperlink{platform_8c_a4e984a09b582ada83d582322f65c9d1a}{log\+Message} (cstring\+\_\+t message, int level)
\item 
int \hyperlink{platform_8c_a365b2a06835658e622a46fa55036cdc3}{sock\+Err} ()
\item 
int \hyperlink{platform_8c_aa3293b3523eb32765bda965f292b2f89}{close\+Socket} (int s)
\item 
const char $\ast$ \hyperlink{platform_8c_a607b7fbf1ab0ed884f622fc85c53034c}{inet\+Ntoa} (const struct in\+\_\+addr $\ast$addr, void $\ast$dst, size\+\_\+t size)
\item 
int \hyperlink{platform_8c_af3ddaf69b66cb3b02afa4ac4603a7f65}{detach\+Thread} (pthread\+\_\+t tid)
\item 
int \hyperlink{platform_8c_a37ac383aec018d987faa5751da7bf894}{start\+Thread} (pthread\+\_\+t $\ast$tid, L\+P\+T\+H\+R\+E\+A\+D\+\_\+\+S\+T\+A\+R\+T\+\_\+\+R\+O\+U\+T\+I\+NE routine, void $\ast$args)
\item 
int \hyperlink{platform_8c_afd3d7cf7c06200399620828a2e44a0e1}{daemonize} ()
\item 
int \hyperlink{platform_8c_a5ff45f4458f458d37d427bf5e676f22a}{file\+Attributes} (cstring\+\_\+t path)
\item 
int \hyperlink{platform_8c_afc7e96be2f7333bcc10813fdebcf124a}{get\+File\+Size} (cstring\+\_\+t path)
\item 
int \hyperlink{platform_8c_a135c09a3fee8c20311691644b6f7f289}{get\+File\+Map} (const char $\ast$path, \hyperlink{structfile__mapping__t}{file\+\_\+mapping\+\_\+t} $\ast$map\+Data)
\item 
int \hyperlink{platform_8c_a7bb8187cc6699727cffa1fad62b012a8}{iterate\+Dir} (const char $\ast$path, D\+IR $\ast$$\ast$dir, char $\ast$name, size\+\_\+t name\+Size)
\item 
int \hyperlink{platform_8c_ac3bd701d411e7733371acc9810ac58f2}{close\+Dir} (D\+IR $\ast$dir)
\item 
int \hyperlink{platform_8c_a3a359d5a433a1e941b0f312bf1cd15ef}{unmap\+Mem} (void $\ast$addr, size\+\_\+t len)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{platform_8c_ac068d0e6cb88339c481e522c9795e173}{enable\+Logging} = true
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{platform_8c_af8377fbc4061f7e7773e0ef33ac8a73f}\label{platform_8c_af8377fbc4061f7e7773e0ef33ac8a73f}} 
\index{platform.\+c@{platform.\+c}!change\+Cwd@{change\+Cwd}}
\index{change\+Cwd@{change\+Cwd}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{change\+Cwd()}{changeCwd()}}
{\footnotesize\ttfamily int change\+Cwd (\begin{DoxyParamCaption}\item[{cstring\+\_\+t}]{path }\end{DoxyParamCaption})}

Changes the current working directory to path. \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_ac3bd701d411e7733371acc9810ac58f2}\label{platform_8c_ac3bd701d411e7733371acc9810ac58f2}} 
\index{platform.\+c@{platform.\+c}!close\+Dir@{close\+Dir}}
\index{close\+Dir@{close\+Dir}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{close\+Dir()}{closeDir()}}
{\footnotesize\ttfamily int close\+Dir (\begin{DoxyParamCaption}\item[{\+\_\+dir}]{dir }\end{DoxyParamCaption})}

Closes the dir object opened by \hyperlink{platform_8h_a0cec7649e32d72daadab4beb95e6ef96}{iterate\+Dir()} \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_aa3293b3523eb32765bda965f292b2f89}\label{platform_8c_aa3293b3523eb32765bda965f292b2f89}} 
\index{platform.\+c@{platform.\+c}!close\+Socket@{close\+Socket}}
\index{close\+Socket@{close\+Socket}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{close\+Socket()}{closeSocket()}}
{\footnotesize\ttfamily int close\+Socket (\begin{DoxyParamCaption}\item[{socket\+\_\+t}]{s }\end{DoxyParamCaption})}

Closes the socket s. \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_afd3d7cf7c06200399620828a2e44a0e1}\label{platform_8c_afd3d7cf7c06200399620828a2e44a0e1}} 
\index{platform.\+c@{platform.\+c}!daemonize@{daemonize}}
\index{daemonize@{daemonize}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{daemonize()}{daemonize()}}
{\footnotesize\ttfamily int daemonize (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Transforms the current process into a daemon process. \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_af3ddaf69b66cb3b02afa4ac4603a7f65}\label{platform_8c_af3ddaf69b66cb3b02afa4ac4603a7f65}} 
\index{platform.\+c@{platform.\+c}!detach\+Thread@{detach\+Thread}}
\index{detach\+Thread@{detach\+Thread}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{detach\+Thread()}{detachThread()}}
{\footnotesize\ttfamily int detach\+Thread (\begin{DoxyParamCaption}\item[{thread\+\_\+t}]{tid }\end{DoxyParamCaption})}

Detaches the thread tid. \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_a2b652b5d50088ca766e09ba7115e9a9e}\label{platform_8c_a2b652b5d50088ca766e09ba7115e9a9e}} 
\index{platform.\+c@{platform.\+c}!ends\+With@{ends\+With}}
\index{ends\+With@{ends\+With}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{ends\+With()}{endsWith()}}
{\footnotesize\ttfamily bool ends\+With (\begin{DoxyParamCaption}\item[{cstring\+\_\+t}]{str1,  }\item[{cstring\+\_\+t}]{str2 }\end{DoxyParamCaption})}

\begin{DoxyReturn}{Returns}
true if the string str2 ends with the string str2. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_a5ff45f4458f458d37d427bf5e676f22a}\label{platform_8c_a5ff45f4458f458d37d427bf5e676f22a}} 
\index{platform.\+c@{platform.\+c}!file\+Attributes@{file\+Attributes}}
\index{file\+Attributes@{file\+Attributes}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{file\+Attributes()}{fileAttributes()}}
{\footnotesize\ttfamily int file\+Attributes (\begin{DoxyParamCaption}\item[{cstring\+\_\+t}]{path }\end{DoxyParamCaption})}

Retrieves the attributes of a file. \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+I\+S\+F\+I\+LE or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+I\+S\+D\+IR. Upon error returns P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE, or-\/ed with P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+N\+O\+T\+\_\+\+F\+O\+U\+ND if the file was not found. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_aed6aaedf110cf3f079f707ca8c8a58a7}\label{platform_8c_aed6aaedf110cf3f079f707ca8c8a58a7}} 
\index{platform.\+c@{platform.\+c}!get\+Cwd@{get\+Cwd}}
\index{get\+Cwd@{get\+Cwd}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{get\+Cwd()}{getCwd()}}
{\footnotesize\ttfamily int get\+Cwd (\begin{DoxyParamCaption}\item[{string\+\_\+t}]{dst,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}

Copies the current working directory in dst. \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_a135c09a3fee8c20311691644b6f7f289}\label{platform_8c_a135c09a3fee8c20311691644b6f7f289}} 
\index{platform.\+c@{platform.\+c}!get\+File\+Map@{get\+File\+Map}}
\index{get\+File\+Map@{get\+File\+Map}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{get\+File\+Map()}{getFileMap()}}
{\footnotesize\ttfamily int get\+File\+Map (\begin{DoxyParamCaption}\item[{cstring\+\_\+t}]{path,  }\item[{\hyperlink{structfile__mapping__t}{file\+\_\+mapping\+\_\+t} $\ast$}]{map\+Data }\end{DoxyParamCaption})}

Create a file memory mapping. 
\begin{DoxyParams}{Parameters}
{\em path} & The path to the file to be mapped. \\
\hline
{\em map\+Data} & A pointer to the \hyperlink{structfile__mapping__t}{file\+\_\+mapping\+\_\+t} struct to be filled with the memory mapping. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_afc7e96be2f7333bcc10813fdebcf124a}\label{platform_8c_afc7e96be2f7333bcc10813fdebcf124a}} 
\index{platform.\+c@{platform.\+c}!get\+File\+Size@{get\+File\+Size}}
\index{get\+File\+Size@{get\+File\+Size}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{get\+File\+Size()}{getFileSize()}}
{\footnotesize\ttfamily int get\+File\+Size (\begin{DoxyParamCaption}\item[{cstring\+\_\+t}]{path }\end{DoxyParamCaption})}

\begin{DoxyReturn}{Returns}
The size of the file path, or -\/1 upon failure. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_a607b7fbf1ab0ed884f622fc85c53034c}\label{platform_8c_a607b7fbf1ab0ed884f622fc85c53034c}} 
\index{platform.\+c@{platform.\+c}!inet\+Ntoa@{inet\+Ntoa}}
\index{inet\+Ntoa@{inet\+Ntoa}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{inet\+Ntoa()}{inetNtoa()}}
{\footnotesize\ttfamily const char$\ast$ inet\+Ntoa (\begin{DoxyParamCaption}\item[{const struct in\+\_\+addr $\ast$}]{addr,  }\item[{void $\ast$}]{dst,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}

\begin{DoxySeeAlso}{See also}
inet\+\_\+ntoa \mbox{[}Windows\mbox{]} 

inet\+\_\+ntop \mbox{[}Linux\mbox{]} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{platform_8c_a7bb8187cc6699727cffa1fad62b012a8}\label{platform_8c_a7bb8187cc6699727cffa1fad62b012a8}} 
\index{platform.\+c@{platform.\+c}!iterate\+Dir@{iterate\+Dir}}
\index{iterate\+Dir@{iterate\+Dir}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{iterate\+Dir()}{iterateDir()}}
{\footnotesize\ttfamily int iterate\+Dir (\begin{DoxyParamCaption}\item[{cstring\+\_\+t}]{path,  }\item[{\+\_\+dir $\ast$}]{dir,  }\item[{string\+\_\+t}]{name,  }\item[{size\+\_\+t}]{name\+Size }\end{DoxyParamCaption})}

Reads the next files of a directory and copies its relative path in name. If dir is N\+U\+LL, opens the directory path and initializes dir for further calls. If dir is non-\/\+N\+U\+LL, path is ignored (thus can be N\+U\+LL), and the scan continues from the previouse \hyperlink{platform_8h_a0cec7649e32d72daadab4beb95e6ef96}{iterate\+Dir()} call. N\+O\+TE\+: dir must be closed using \hyperlink{platform_8h_a89df221b2d4303be5ae36c1ab470716d}{close\+Dir()} when done. 
\begin{DoxyParams}{Parameters}
{\em path} & The path to a directory to open. Ignored if dir is non-\/\+N\+U\+LL. \\
\hline
{\em dir} & An object representing a directory. Used after the first call to \hyperlink{platform_8h_a0cec7649e32d72daadab4beb95e6ef96}{iterate\+Dir()} for subsequent calls. \\
\hline
{\em name} & A buffer where the file relative path is to be copied. \\
\hline
{\em name\+Size} & The size of the buffer name. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE can be or-\/ed with P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+N\+O\+T\+\_\+\+F\+O\+U\+ND or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+E\+N\+D\+\_\+\+O\+F\+\_\+\+D\+IR. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{platform_8h_a89df221b2d4303be5ae36c1ab470716d}{close\+Dir()} 

opendir() \mbox{[}Linux\mbox{]} 

readdir() \mbox{[}Linux\mbox{]} 

Find\+First\+File() \mbox{[}Windows\mbox{]} 

Find\+Next\+File() \mbox{[}Windows\mbox{]} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{platform_8c_a4e984a09b582ada83d582322f65c9d1a}\label{platform_8c_a4e984a09b582ada83d582322f65c9d1a}} 
\index{platform.\+c@{platform.\+c}!log\+Message@{log\+Message}}
\index{log\+Message@{log\+Message}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{log\+Message()}{logMessage()}}
{\footnotesize\ttfamily void log\+Message (\begin{DoxyParamCaption}\item[{cstring\+\_\+t}]{message,  }\item[{int}]{level }\end{DoxyParamCaption})}

Logs a message to the current logger (syslog or stderr) 
\begin{DoxyParams}{Parameters}
{\em message} & The message to be logged. \\
\hline
{\em level} & The importance level. Can be L\+O\+G\+\_\+\+D\+E\+B\+UG, L\+O\+G\+\_\+\+I\+N\+FO, L\+O\+G\+\_\+\+W\+A\+R\+N\+I\+NG or L\+O\+G\+\_\+\+E\+RR. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{platform_8c_adb504f94873e3ed50a9fbc948b3f6244}\label{platform_8c_adb504f94873e3ed50a9fbc948b3f6244}} 
\index{platform.\+c@{platform.\+c}!send\+All@{send\+All}}
\index{send\+All@{send\+All}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{send\+All()}{sendAll()}}
{\footnotesize\ttfamily int send\+All (\begin{DoxyParamCaption}\item[{socket\+\_\+t}]{s,  }\item[{cstring\+\_\+t}]{data,  }\item[{int}]{length }\end{DoxyParamCaption})}

Tries to send up to length bytes of data to the socket s. \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_a365b2a06835658e622a46fa55036cdc3}\label{platform_8c_a365b2a06835658e622a46fa55036cdc3}} 
\index{platform.\+c@{platform.\+c}!sock\+Err@{sock\+Err}}
\index{sock\+Err@{sock\+Err}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{sock\+Err()}{sockErr()}}
{\footnotesize\ttfamily int sock\+Err (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyReturn}{Returns}
the current system error relative to the sockets 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_a37ac383aec018d987faa5751da7bf894}\label{platform_8c_a37ac383aec018d987faa5751da7bf894}} 
\index{platform.\+c@{platform.\+c}!start\+Thread@{start\+Thread}}
\index{start\+Thread@{start\+Thread}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{start\+Thread()}{startThread()}}
{\footnotesize\ttfamily int start\+Thread (\begin{DoxyParamCaption}\item[{thread\+\_\+t $\ast$}]{tid,  }\item[{L\+P\+T\+H\+R\+E\+A\+D\+\_\+\+S\+T\+A\+R\+T\+\_\+\+R\+O\+U\+T\+I\+NE}]{routine,  }\item[{void $\ast$}]{args }\end{DoxyParamCaption})}

Starts a new thread. 
\begin{DoxyParams}{Parameters}
{\em tid} & A pointer to a location where the thread id of the spawned thread will be written. \\
\hline
{\em routine} & A pointer to the function to be executed by the new thread. \\
\hline
{\em args} & A pointer to data used as arguments. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}
\mbox{\Hypertarget{platform_8c_a3a359d5a433a1e941b0f312bf1cd15ef}\label{platform_8c_a3a359d5a433a1e941b0f312bf1cd15ef}} 
\index{platform.\+c@{platform.\+c}!unmap\+Mem@{unmap\+Mem}}
\index{unmap\+Mem@{unmap\+Mem}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{unmap\+Mem()}{unmapMem()}}
{\footnotesize\ttfamily int unmap\+Mem (\begin{DoxyParamCaption}\item[{void $\ast$}]{addr,  }\item[{size\+\_\+t}]{len }\end{DoxyParamCaption})}

Unmaps a file memory mapping \begin{DoxyReturn}{Returns}
P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+U\+C\+C\+E\+SS or P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+F\+A\+I\+L\+U\+RE. 
\end{DoxyReturn}


\subsection{Variable Documentation}
\mbox{\Hypertarget{platform_8c_ac068d0e6cb88339c481e522c9795e173}\label{platform_8c_ac068d0e6cb88339c481e522c9795e173}} 
\index{platform.\+c@{platform.\+c}!enable\+Logging@{enable\+Logging}}
\index{enable\+Logging@{enable\+Logging}!platform.\+c@{platform.\+c}}
\subsubsection{\texorpdfstring{enable\+Logging}{enableLogging}}
{\footnotesize\ttfamily bool enable\+Logging = true}

Turn off with option -\/s (silent) to disable server logging. 